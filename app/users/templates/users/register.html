{% extends "ecommerce/default.html" %} 
{% block content %}
{% load static %}
<script src="{% static 'users/register.js' %}" type="text/javascript" ></script>
<div>
  <form method="POST">
    {% comment %} {% csrf_token %} {% endcomment %}
    {{ form }}
    {% comment %} <button type="submit" id="the_btn" >submit!</button>  {% endcomment %}
    <input type="button" value="Click here!" id="the_btn" />
  </form>
</div>
<script>
  function getCookie(name) {
    var cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookie = cookies[i].trim();
            // Does this cookie string begin with the name we want?
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}

  
  $("#the_btn").on("click", function () {
    sendInfo();
  });

  function sendInfo() {
    var email1 = $("#id_email").val();
    var pass1 = $("#id_password1").val();
    var pass2 = pass1;
    $.ajax({
      type: "POST",
      url: "http://localhost:9998/users/register/",
      data: {
        email: email1,
        password1: pass1,
        password2: pass1,
        csrfmiddlewaretoken: getCookie('csrftoken')
      },
      error: function (error) {
        console.log("ridi");
      },
      success: function (result) {
        if (!result.success) {
          console.log("sucess");
        } else {
          window.location.reload();
        }
      },
    });
  }
</script>
{% endblock content %}
